<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pentoryall.admin.mapper.CommentReportMapper">

    <select id="selectAllCommentReportList" resultType="com.pentoryall.admin.dto.CommentReportDTO">
        SELECT r.code, u.code AS user_code, u.user_id, u.nickname, u.state, r.report_date, c.content
          FROM report r
                   JOIN user u ON r.user_code = u.code
                   JOIN comment c ON r.comment_code = c.code
         WHERE r.type = 'comment'
         ORDER BY report_date, user_code
    </select>

    <select id="selectTotalCount" resultType="_int">
        SELECT COUNT(*)
          FROM report
    </select>

    <update id="restoreUserState">
        UPDATE user
           SET state = 'ACTIVE'
         WHERE state = 'SUSPENDED'
           AND code = #{userCode}
    </update>

    <update id="StopUser">
        UPDATE user
           SET state = 'SUSPENDED'
         WHERE state = 'ACTIVE'
           AND code = #{userCode}
    </update>

    <!--    <select id="selectAllCommentReportList" resultType="com.pentoryall.admin.DTO.CommentReportDTO">-->
    <!--        SELECT-->
    <!--            c.user_code,-->
    <!--            u.name,-->
    <!--            c.create_date,-->
    <!--            c.content,-->
    <!--            p.user_code,-->
    <!--            u2.name ,-->
    <!--            p.title-->
    <!--        FROM-->
    <!--            comment c-->
    <!--                JOIN-->
    <!--            post p ON c.post_code = p.code-->
    <!--                JOIN-->
    <!--            user u ON c.user_code = u.code-->
    <!--                JOIN-->
    <!--            user u2 ON p.user_code = u2.code;-->

    <!--    </select>-->

</mapper>

